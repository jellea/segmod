<script src="/segmod2.out.js"></script>
<script src="/riff-wave.js"></script>
<script>

	Module.onRuntimeInitialized = _ => {
		window.read = () => {
		   var audio = new Audio();
		   tableFrews = document.getElementById("freqs").value
		   tableData = document.getElementById("table").value
	           vec = Module.gen(tableFrews, tableData);
		   data = [];
	           //data = new Float32Array(vec.size());

		   //data.from
		   for (var i = 0; i < vec.size(); i++) {
		        //console.log("Vector Value: ", vec.get(i));
			// TODO: figure out correct type over wasm->js embind
		     data[i] = vec.get(i);
		     //   data.set(vec.get(i);
		   }
		   var wave = new RIFFWAVE();
		   wave.header.bitsPerSample = 16;
                   wave.header.sampleRate = 44100;
                   wave.header.numChannels = 1;
                   wave.Make(data);
		   console.log(wave);
		   audio.src = wave.dataURI;
		   audio.play();
		}
	};

</script>

<input id="freqs" value="200 300 400 500 600 700"/>
<br>
<textarea id="table"></textarea>
<br>

<button onclick="read()">play</button>
